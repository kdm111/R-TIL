## Day 1


### 개요
PLC의 일부만 하게될 것이다. 기본 동작은 할 수 있게 만드는 것이 목표이다.

자동화와 로봇의 관계
자동화와 로봇은 같은 말이다. 자동화의 설비 자체가 로봇 설비 담당자와 소통을 해야 한다.
자동화 라인이 로봇에게 신호를 주면 주게 된다. 

### 목표
PLC 프로그래밍, hmi touch 작화, server control -> mps 장비 제어
modbus/tcp 통신에 대한 이해

자동화설비 산업기사 실기 검정 진도 도달
plc와 로봇과의 통신 체계와 실습
현장 사진/영상 자료를 통하여 현장 분위기 파악

1. plc 기초역량
2. hmi 작화 및 plc와 연동
3. serveo 모터 파라미터 세팅 & 프로그래밍 및 plc, hmi와 연동
4. modbus/tcp, tru, socket communication
5. mini project 및 발표

### 자동화의 목적

1. 단순하고 반복적인 작업
2. 고정밀, 고위험, 고반복 작업

자동화 -> 로봇으로 치환


### 자동화의 5대 요소
1. 프로세서 : 두뇌
2. 액츄에이터 : 실린더, 모터
3. 소프트웨어 : 소프트웨어
4. 네트워크 : 통신
5. 센서 : 눈,코,입


#### 1. 프로세서
일반적 공장 자동화
PLC : 단일 설비 제어(공정/장비 자동화)
PAC : PLC + PC, PLC + 데이터 네트워크 처리 기능
DCS : 대규모 자동화 설비 제어, 프로세서 산업(화학, 석유)

소규모 자동화 및 IoT
MCU : 아두이노 esp32, stm32
MPU 임베디드 : 라즈베리파이, arm cortext

복잡한 연산 및 ai 자동화
산업용 pc, 서버, fpga, asic

#### 2. 액추에이터
전기식 액추에이터 : 가장 정밀함.
정밀제어, 유지보수 용이, 높은 에너지 효율

서보모터 : 고정밀 회전제어, 피드백을 통한 위치, 속도 제어.
스테핑 모터 : 정확한 각도 (스텝)으로 회전

**서보 모터와 스테핑 모터**
피드맥 유무 : 서보모터는 엔코더를 통해 피드백한다. 스테핑 모터는 명령만큼 움직인다.
정밀도 : 서보모터는 오차 보정 가능으로 정밀도가 높다. 스테핑 모터는 높지만 미끄러짐 위험이 있다.
가격 : 서보 모터는 높다. 스테핑모터는 낮다.
용도 : 서보모터는 MPS 장비의 정밀 이송축. 스테핑 모터는 3D 프린터 혹은 단순 회전체 역할을 한다.

솔레노이드 : 전자기력, on/off. 전자식 밸브 제어

유압식 액추에이터 : MPS 장비의 핵심 빠르고 안전함.
강한힘, 느린응답, 누유

유압 실린더 : 높은 하중을 견디고 일정한 힘을 유지
유압 모터 : 큰 힘으로 회전운동
유압 밸브 : 유압 이용 밸브 개폐

공압식 액추에이터
빠른 응답. 단순 구조 쉬운 유지보수. 공기 압축 특성상 정밀 제어

공압 실린더 : 압축공기를 이용 직선운동 수행
공압 모터 : 압축 공기로 회전운동
공압 밸브 : 공압을 통해 밸브 계폐

#### 3. 소프트웨어
제어로직 : PLC 프로그래밍
인터페이스 : 사람과 기계의 소통창구
운영/관리 : 상위 서버 생산계획, 자재관리, 데이터 통계
미들웨어 : 미들웨어 

#### 4. 네트워크
필드버스 네트워크
profibus : 장비간 네트워크
modbus : 
canopen : 

산업용 이더넷 네트워크
ethernet/ip : 산업용 이더넷 프로토콜
etercat : 고속 데이터 처리. 리얼타임 이더넷
profinet : 지멘스 주로 사용 
modbus/tcp : 
높은 호환성과 개방성. 앞으로 아주 중요할 것
Client/Server 모델
Client(Master) : 데이터를 요청하는 쪽 PC나 HMI
Server(Slave) : 데이터를 갖고있다가 요청에 답하는 쪽(PLC)
modbus는 데이터를 Coils, Discrete Inputs, Holding Registers, Input Registers 4개 영역을 관리
이 주소 체계를 PLC 주소와 매핑하는 것이 핵심이다.


무선 네트워크
wifi : 


#### 5. 센서
위치 및 거리
- 이진센서 : 있다 없다.
근접센서 : 비접촉 물체 감지
광전센서 : 빛을 쏘아 물체 감지
리미트 스위치 : 물체가 특정 위치 도달을 접촉, 감지

-측정센서 : 수치를 읽음
엔코더 : 로봇 관절의 회전각도 및 속도 측정
힘/토크 센서 : 로봇 tool에 가해지는 힘 측정
변위센서 : 레이저/초음파로 정확한 거리 측정
비전센서 : 카메라로 형상인식

변위 및 거리
초음파 센서 : 초음파 반사로 거리 및 높이 측정
레이저 센서 : 정밀한 거리 및 위치 측정
적외선 센서

전체 구조도

🏭 자동화 제어 시스템 아키텍처
Plaintext

       [ 상위 제어 및 모니터링 ]
      ┌───────────────────────┐
      │       PC(HMI) (User)  │
      │  (Control Software)   │
      └──────────┬────────────┘
                 │
        ◀── Modbus/TCP ──▶
                 │
      ┌──────────┴────────────┐          ┌──────────────────┐
      │    Server / Inverter  │◀───────▶│  Data Log / Drive│
      └──────────┬────────────┘          └──────────────────┘
                 │
                 │ (Internal Bus / Fieldbus)
                 │
      ┌──────────┴────────────┐
      │    Processor (PLC)    │ ◀─── [ 두뇌: 로직 판단 ]
      └──────────┬────────────┘
        ▲        │        │
        │        │        ▼
┌───────┴──────┐ │ ┌──────────────┐
│    Sensor    │ │ │   Actuator   │
│  (Detect)    │ │ │  (Command)   │
└──────────────┘ │ └──────────────┘
 [ 눈: 상태 감지 ]   [ 팔다리: 실제 동작 ]

계전기, 릴레이
증폭 기능
매우 작은 전류를 이용하여 릴레이의 전자석을 작동, 이때 동작하는 접점을 이용하여 매우 큰 전류를 제어
5V만 사용하여 220V의 전자기기를 제어한다?
자동차 스타터 모터, 전조등 <-> 운전석 스위치

교환 기능
서로 다른 전압으로 전기제품을 동작 시킬때

신호 전달 기능
릴레이에 있는 접점들이 달라붙거나 떨어지며 연결선이 신호로 제어된다.
이 PLC의 가장 근본이다. 


릴레이 제어반의 문제점
물리적이고 하드웨어적으로 시스템을 설계하는 과정이 필수적이였어서, 다르게 바뀐다.


### PLC
Programmable Logic Controller
기존 릴레이 제어반의 기능을 반도체로 대체하여 시퀀스 제어 기능을 보다 쉽게 할 수 있도록 구성된 장치
디지털 도는 아날로그 입,출력 모듈을 통하여 로직, 시퀀스, 타이머, 카운터 그 외 연산과 같은 특수한 기능을 수행하기 위해 프로그램 가능한 메모리를 사용하고 여러 종류의 기계나 프로세서를 제어하는 디지털 동작의 전자장치


#### PLC의 구성
[ 외부 시스템 ]            [ PLC 시스템 (Main) ]           [ 현장 장치 ]
     ┌─────────────┐           ┌───────────────────┐          ┌─────────────┐
     │ 상위 Server │           │   CPU (연산부)    │          │  액추에이터 │
     │ (Modbus/TCP)│◀─────────▶│ (Logic / Memory)  │─────────▶│ (모터,밸브) │
     └──────┬──────┘           └─────────┬─────────┘          └──────┬──────┘
            │                            │                           │
     ┌──────┴──────┐           ┌─────────┴─────────┐          ┌──────┴──────┐
     │  HMI Touch  │           │   통 신 모 듈     │          │    센 서    │
     │ (인터페이스)│◀─────────▶│ (Ethernet/Field)  │◀─────────┤ (광전,근접) │
     └─────────────┘           └─────────┬─────────┘          └─────────────┘
                                         │
     ┌─────────────┐           ┌─────────┴─────────┐          ┌─────────────┐
     │ 프로그램 PC │           │   I/O 모듈        │          │   안전 장치 │
     │ (SW / Loader)│◀─────────▶│ (입력/출력 카드)  │◀─────────┤ (비상스위치)│
     └─────────────┘           └─────────┬─────────┘          └─────────────┘
                                         │
                               ┌─────────┴─────────┐
                               │     전 원 부      │
                               │ (AC 220V / DC 24V)│
                               └───────────────────┘
구성
cpu 
프로그램 메모리 : eprom 
데이터 메모리 : ram
시스템 메모리 : rom

입출력부
입력기기 신호 PLC 전달
출력신호 전달

전원부
PLC 전원공급




#### PLC와 일반 PC와 다른점
PLC는 장비 제어 최적화
시스템 안정, 간단 프로그램, 우수 내구성
열악한 환경에서 장시간 구동가능 HW

PC는 알수없는 이유로 시스템이 다운되는 경우 다수
PC는 PLC보다 비교적 더 복잡한 프로그래밍 지식이 필요
PC는 LED 한개 켜는 것도 복잡함
PC 부품 내구성이 산업 기준에 미달. 유지보수 비용발생

#### Relay 시스템의 병렬연산방식
[전원 +] -------------------------- [전원 -]
          |          |          |
        (스위치1)  (스위치2)  (스위치3)  <-- 동시에 입력 대기
          |          |          |
        [램프1]     [램프2]     [램프3]   <-- 1,2,3 조건 맞으면 "동시에" 켜짐
동시에 입력하고 연산하여 그 결과에 따라 동작한다.

#### PLC 시스템의 직렬연산방식
(시작)
  ↓
[ 1번 줄 ]  (A접점) ---- (B접점) ---- (출력 Coil)  <-- 1단계: 왼쪽에서 오른쪽으로 연산
  ↓
[ 2번 줄 ]  (A접점) ----------------- (출력 Coil)  <-- 2단계: 위에서 아래로 이동
  ↓
[ 3번 줄 ]  (A접점) ---- (T타이머) --- (출력 Coil)  <-- 3단계: 다음 줄 연산
  ↓
(끝 / 다시 시작)
좌에서 우로 위에서 아래로 한접점씩 한줄씩 한번에 한 접점만 연산하여 진행

**스캔 타임**
입력 읽기 : 실제 스위치 상태를 메모리에 저장
프로그램 실행 : 위에서 아래로 좌에서 우로 연산. 입력이 바뀌어도 결과에 즉시 반영되지 않음.
출력 내보내기(output refresh) : 연산결과를 한꺼번에 출력 단자로 전달


#### PLC의 기능
sequence : 디지털 입출력 제어
Logic 연산 : and, or , not , xor
산술연산 : 실수 가감승제, 삼각함수 연산
timer : 시간지연, 시간적산
counter : 펄스 카운터
analog 입력 : 아날로그 신호 디지털 변환
analog 출력 입력된 디지털 수치 아날로그 신호화
pulse 입출력 : stepping motor, servo motor 제어
통신 : ethernet 등 이용 plc와 주변기기 연결


#### PLC의 분류
일체형
소형 자동화시스템
전원 cpu 입 출력 하나의 케이스

취급이 간단하고 비교적 저가
입출력 개수가 고정되어 있어서 주의 필요.

모듈형
일체형 PLC에 비해 고속처리 대용량처리가능
베이스 보드를 기반으로 자유로움.

#### PLC 시스템의 접점
A접점(NO) : Normally Open
Activate -> ON 
전기가 들어오면 바로 OFF 스위치가 눌려야 ON

B접점(NC) : Normally Close
Break -> ON
전기가 들어오면 바로 ON 스위치가 눌려야 OFF

코일(부하) : 

예시)
A접점 X1 && B접점 X2 = Y20
      X1             X2             Y20
|-----| |------------|/|------------( )-----|
   (A접점/신호)    (B접점/차단)    (출력/코일)



[ 입력부 (Input) ]            [ PLC 본체 ]            [ 출력부 (Output) ]
                         ____________________
  (전원 +) ----+         |                    |         +---- (전원 +)
              |         |      [CPU]         |         |
           [스위치 X0] --|-- (X0)      (Y0) --|-- [램프 Y0]
              |         |                    |         |
           [스위치 X1] --|-- (X1)      (Y1) --|-- [램프 Y1]
              |         |                    |         |
  (전원 -) ----COM ------|-- [COM]    [COM] --|---------+---- (전원 -)
                         |____________________|



#### 미쯔비시 공식 매뉴얼 파일 다운로드
상단 중간 고객지원 > 다운로드(sw) > 여기에서 필요한 파일 다운로드

### 프로젝트 설정
1. project > new
2. 
series : qcpu(q mode)
type : Q03UDV
project type : simple project
language : Ladder

PLC 시스템의 내부 릴레이(실체가 없는 내부 릴레이) 디바이스 M(M은 내부 식별자)
연산에 필요한 비트 정보를 저장

X1 -< M1 : 이 때 M1이 여자되고 내부 접점들이 반전된다.
M1 -< Y20 : 여자되며 연결이 된다.
!M1 -< Y21 : 여자되며 연결이 안된다.
END

F4 : 프로그램 작성 후 빌드
단자에 shift + enter를 하면 software에 on이 된다.
software on 이후 off를 까먹으면 계속 on 상태로 유지되어 있게 된다.
PLC에 전송하였을 때도 ON상태를 유지한다.
F2 : 모니터링 모드에서 빠져나와 수정하게 된다.
F3 : 모니터링 모드로 다시 들어가게 된다.


