# 🎤 발표 대본 — PLC-PC 연동 스마트 팩토리 제어 시스템

> 예상 소요: 12~15분

---

## 슬라이드 1 — 표지 (30초)

안녕하세요, 박준수입니다. 저는 "PLC-PC 연동 스마트 팩토리 제어 시스템"을 주제로 발표하겠습니다. 이 프로젝트는 Python과 Modbus TCP 통신을 이용해서, 한국어 자연어 명령 한 줄로 PLC 공정을 원격 제어하는 시스템을 만든 프로젝트입니다. 화면 하단에 보이는 것처럼 Modbus TCP, pymodbus, Streamlit, Mitsubishi Q03UDE PLC를 사용했습니다.

---

## 슬라이드 2 — 목차 (15초)

발표 순서입니다. 프로젝트 배경, 목표, 시스템 아키텍처, 자연어 명령 설계, 레지스터 매핑, 소프트웨어 구조, 구현 현황, 결론 순서로 진행하겠습니다.

---

## 슬라이드 3 — 프로젝트 배경 및 동기 (2분)

먼저 프로젝트 배경입니다. 저희가 실습에서 사용한 장비는 MPS, 모듈형 생산 시스템입니다. 공급에서 가공, 분배, 저장, 배출까지 이어지는 공정을 Q03UDE PLC로 제어하고, GX Works2로 래더 프로그래밍을 했습니다. 여기서 "이 장비를 PC에서 원격으로 제어할 수 있으면 어떨까?"가 프로젝트의 출발점이었습니다.

채용시장을 보면 자격요건에 C/C++/Python 코딩, TCP/IP 같은 통신 프로토콜 경험이 항상 나옵니다. 우대사항에도 ROS, Docker, CI/CD 등 실무 경험이 요구되고요. 이 프로젝트가 그런 실무 역량을 직접 쌓을 수 있는 좋은 기회라고 생각했습니다.

문제의식은 세 가지였습니다. PLC 혼자서는 AI나 복잡한 연산이 어렵고, 센서 데이터 분석 같은 PC 연산 영역이 늘어나고 있으며, 래더를 매번 수정하지 않고 명령만 바꿔서 공정을 변경하고 싶었습니다.

그래서 핵심 아이디어는 "PC가 두뇌, PLC가 근육"입니다. PC에서 판단하고 Modbus로 전송하면 PLC가 실행하는 역할 분담 구조입니다.

---

## 슬라이드 4 — 프로젝트 목표 (1분 30초)

목표는 네 가지입니다.

첫째, Modbus TCP 소켓 연결. PC와 PLC 사이에 안정적인 TCP/IP 통신 채널을 구축하는 것.

둘째, 자연어 명령 체계. "가공 적재"처럼 한국어 명령을 치면 PLC가 자동 실행하도록 만드는 것.

셋째, 전공정과 후공정을 병렬로 설계. 레지스터를 분리해서 독립적으로 제어 가능하게 한 것.

넷째, Streamlit 기반 실시간 모니터링 UI.

한 줄로 요약하면, "한 줄 명령 → PLC가 이해 → 설비 자동 실행"입니다.

---

## 슬라이드 5 — 시스템 아키텍처 (1분 30초)

시스템 구성도입니다. 왼쪽 PLC에는 래더 프로그램이 돌고, 센서값을 읽고, D5105에 상태를, D6363에서 PC 명령을 수신합니다. 가운데 Modbus TCP는 192.168.3.40 포트 502로 연결되고, FC02로 DI 읽기, FC03으로 HR 읽기, FC16으로 HR 쓰기를 합니다. 오른쪽 Python 서버에서는 pymodbus, 자연어 파서, 트리거 로직, Streamlit 대시보드가 있습니다.

하단 흐름을 보시면, 사용자가 "가공 적재"를 입력하면 PC가 파싱 → HR 값을 쓰고 → PLC 래더가 실행 → 로봇팔이 동작하는 전체 과정입니다.

---

## 슬라이드 6 — Streamlit UI 구성 (1분)

이 슬라이드는 Streamlit으로 만든 웹 UI입니다. 왼쪽 사이드바에서 서버 시작/정지, IP/포트 설정, 연결 상태, 자동 갱신 주기를 관리합니다. 탭으로 장비상태, 공정데이터, 레지스터 직접 조회까지 가능합니다.

오른쪽은 명령 제어 영역입니다. 텍스트로 직접 입력하거나, 전공정·후공정·제어 버튼을 눌러서 명령을 보낼 수 있습니다. 예를 들어 "가공 적재"를 입력하면 HR100에 2, HR102에 2203, HR106에 2301이 자동으로 세팅됩니다.

---

## 슬라이드 7 — 자연어 명령 시스템 (2분)

이 프로젝트의 핵심입니다. 설계 철학은 미리 정해둔 전공정·후공정 단어를 조합하면 한 줄로 PLC를 제어하는 구조입니다.

전공정은 공급=1, 가공=2, 분배=3. HR100에 쓰고 HR104에 트리거 2101을 넣으면 됩니다. 후공정은 저장=2201, 배출=2202, 적재=2203, 하역=2204. HR102에 코드, HR105에 트리거를 넣습니다.

조합 예시를 보시면, "가공 적재"는 전공정과 후공정이 동시에 인식돼서 순차실행 트리거 2301이 들어갑니다. "정지"를 치면 HR107에 1을 쓰고 모든 트리거를 OFF합니다.

핵심은 전공정·후공정 레지스터가 분리되어 있어서 독립 트리거가 가능하다는 것이고, 펄스 방식으로 0.5초 후 자동 OFF됩니다.

---

## 슬라이드 8 — 레지스터 매핑 및 트리거 (1분 30초)

레지스터 테이블입니다. 왼쪽 HR 0~19번은 PLC가 PC에 보내는 상태값입니다. 공정 상태, 서보 위치, 압력·온도·진동, 완료 플래그, 에러 코드. 오른쪽 HR 100~119번은 PC가 PLC에 보내는 명령입니다.

아래 트리거 동작 흐름은 명령 코드 → 트리거 ON → PLC 래더 조건 성립 → 공정 실행 → 0.5초 후 트리거 OFF. 이 펄스 방식은 PLC 래더가 상승 에지로 동작하기 때문에 필요합니다.

---

## 슬라이드 9 — PLC 래더 프로그래밍 (1분)

GX Works2에서 작성한 래더 프로그램의 Modbus 연동 핵심 흐름입니다. 5단계로 요약됩니다.

D6363, 즉 HR100을 읽어서 PC 명령을 확인하고, D6367이 2101인지 트리거를 체크합니다. 조건이 맞으면 MOV 명령으로 해당 공정 서브루틴을 호출하고, 완료되면 D5120에 플래그를 설정합니다. 마지막으로 트리거 OFF를 감지하면 초기 상태로 복귀합니다.

---

## 슬라이드 10 — 소프트웨어 아키텍처 (1분)

3계층 구조입니다. 최상위 Presentation은 Streamlit UI, 중간 Application은 정규식 NLP 파서와 트리거 관리, 하위 Communication은 pymodbus TCP 서버입니다. 단일 파일 구조이고, threading으로 비동기 처리, session_state로 UI 상태를 유지합니다.

---

## 슬라이드 11 — 구현 현황 및 한계점 (1분 30초)

완료된 것은 Modbus TCP 소켓 연결, HR/DI 매핑, 자연어 파서, 트리거 시스템, Streamlit UI입니다. 미구현은 실제 PLC 연동 테스트, 시퀀스 자동화, 에러 핸들링, DB 저장입니다.

전체 약 40% 진행됐고, 가장 어려웠던 점은 문제 원인이 통신인지 래더인지 분리하는 것이었습니다. 시뮬레이터로 분리 검증을 시도했습니다.

---

## 슬라이드 12 — 결론 (30초)

이 프로젝트로 TCP 소켓 기반 산업용 통신 구조를 직접 설계·구현하면서, PLC-PC 연동의 실무적 기초와 자연어 명령 체계의 가능성을 확인했습니다. 감사합니다.

---

> **💡 발표 팁**
> - 시연 가능하면 Streamlit 대시보드 띄워놓고 "가공 적재" 명령 데모가 효과적
> - 레지스터 슬라이드에서 테이블을 가리키며 "이 값이 바뀌면 PLC가 이렇게 동작"으로 설명
> - Q&A 예상: "왜 Modbus?" → 산업 현장 표준 + Q03UDE 이더넷 내장으로 변환기 없이 TCP 통신 가능
> - Q&A 예상: "40%인데 더 하실 건가요?" → 에러 핸들링과 실장비 연동 테스트를 우선 보완 예정
